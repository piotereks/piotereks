import{r as ge,g as ce,a as S,R as F,L as Z,E as fe}from"./vendor-echarts-nZu8rBDa.js";import{r as ye}from"./vendor-react-BVyvVbwp.js";import{r as be}from"./vendor-utils-F0zOxUcV.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const u of d)if(u.type==="childList")for(const g of u.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&a(g)}).observe(document,{childList:!0,subtree:!0});function i(d){const u={};return d.integrity&&(u.integrity=d.integrity),d.referrerPolicy&&(u.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?u.credentials="include":d.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function a(d){if(d.ep)return;d.ep=!0;const u=i(d);fetch(d.href,u)}})();var B={exports:{}},G={};var Q;function Se(){if(Q)return G;Q=1;var e=ge(),t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,d=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function g(b,p,R){var f,N={},o=null,w=null;R!==void 0&&(o=""+R),p.key!==void 0&&(o=""+p.key),p.ref!==void 0&&(w=p.ref);for(f in p)a.call(p,f)&&!u.hasOwnProperty(f)&&(N[f]=p[f]);if(b&&b.defaultProps)for(f in p=b.defaultProps,p)N[f]===void 0&&(N[f]=p[f]);return{$$typeof:t,type:b,key:o,ref:w,props:N,_owner:d.current}}return G.Fragment=i,G.jsx=g,G.jsxs=g,G}var X;function xe(){return X||(X=1,B.exports=Se()),B.exports}var s=xe(),W={},ee;function Ne(){if(ee)return W;ee=1;var e=ye();return W.createRoot=e.createRoot,W.hydrateRoot=e.hydrateRoot,W}var Ce=Ne();const ve=ce(Ce),de=S.createContext(),Re=({children:e})=>{const[t,i]=S.useState(localStorage.getItem("parking_theme")==="light");S.useEffect(()=>{t?(document.body.classList.remove("dark"),localStorage.setItem("parking_theme","light")):(document.body.classList.add("dark"),localStorage.setItem("parking_theme","dark"))},[t]);const a=()=>i(!t);return s.jsx(de.Provider,{value:{isLight:t,toggleTheme:a},children:e})},ue=()=>S.useContext(de);var we=be();const Le=ce(we),te=e=>{let t;const i=new Set,a=(R,f)=>{const N=typeof R=="function"?R(t):R;if(!Object.is(N,t)){const o=t;t=f??(typeof N!="object"||N===null)?N:Object.assign({},t,N),i.forEach(w=>w(t,o))}},d=()=>t,b={setState:a,getState:d,getInitialState:()=>p,subscribe:R=>(i.add(R),()=>i.delete(R))},p=t=e(a,d,b);return b},je=(e=>e?te(e):te),Ee=e=>e;function De(e,t=Ee){const i=F.useSyncExternalStore(e.subscribe,F.useCallback(()=>t(e.getState()),[e,t]),F.useCallback(()=>t(e.getInitialState()),[e,t]));return F.useDebugValue(i),i}const ae=e=>{const t=je(e),i=a=>De(t,a);return Object.assign(i,t),i},Te=(e=>e?ae(e):ae),h=Te((e,t)=>({realtimeData:[],realtimeLoading:!0,realtimeError:null,lastRealtimeUpdate:null,historyData:[],historyLoading:!1,lastHistoryUpdate:null,fetchInProgress:!1,refreshCallback:null,stopAutoRefresh:null,cacheCleared:!1,setRealtimeData:a=>e({realtimeData:a}),setRealtimeLoading:a=>e({realtimeLoading:a}),setRealtimeError:a=>e({realtimeError:a}),setLastRealtimeUpdate:a=>e({lastRealtimeUpdate:a}),setHistoryData:a=>e({historyData:a}),setHistoryLoading:a=>e({historyLoading:a}),setLastHistoryUpdate:a=>e({lastHistoryUpdate:a}),setFetchInProgress:a=>e({fetchInProgress:a}),setRefreshCallback:a=>e({refreshCallback:a}),setStopAutoRefresh:a=>e({stopAutoRefresh:a}),setCacheCleared:a=>e({cacheCleared:a}),updateRealtimeState:a=>e(a),updateHistoryState:a=>e(a),resetStore:()=>e({realtimeData:[],realtimeLoading:!0,realtimeError:null,lastRealtimeUpdate:null,historyData:[],historyLoading:!1,lastHistoryUpdate:null,fetchInProgress:!1,refreshCallback:null})})),me=async()=>{const e=h.getState().refreshCallback;e?await e():console.warn("Refresh callback not set yet")},he=()=>{try{typeof localStorage<"u"&&(localStorage.removeItem("parking_realtime_cache"),localStorage.removeItem("parking_history_cache")),h.setState({fetchInProgress:!1,cacheCleared:!0});const e=h.getState().stopAutoRefresh;if(typeof e=="function")try{e()}catch(t){console.warn("stopAutoRefresh failed",t)}console.log("Cache cleared and auto-refresh stopped")}catch(e){console.error("clearCache failed",e)}};typeof window<"u"&&(window.clearCache=he);const Ie=S.createContext(),_e=["https://gd.zaparkuj.pl/api/freegroupcountervalue.json","https://gd.zaparkuj.pl/api/freegroupcountervalue-green.json"],ke="https://corsproxy.io/?",Ue="https://docs.google.com/spreadsheets/d/e/2PACX-1vTwLNDbg8KjlVHsZWj9JUnO_OBIyZaRgZ4gZ8_Gbyly2J3f6rlCW6lDHAihwbuLhxWbBkNMI1wdWRAq/pub?gid=411529798&single=true&output=csv",Ae="https://docs.google.com/forms/d/e/1FAIpQLSdeQ-rmw_VfOidGmtSNb9DLkt1RfPdduu-jH898sf3lhj17LA/formResponse",q={GREENDAY_VALUE:"entry.2026993163",GREENDAY_TIME:"entry.51469670",UNI_VALUE:"entry.1412144904",UNI_TIME:"entry.364658642"},se="parking_realtime_cache",Y="parking_history_cache",I={GD_TIME:"gd_time",GD_VALUE:"greenday free",UNI_TIME:"uni_time",UNI_VALUE:"uni free"},re=e=>e?e.trim().toLowerCase():"",Pe=(e,t)=>{if(!e)return null;const i=re(t);return Object.keys(e).find(a=>re(a)===i)||null},J=(e,t)=>{const i=Pe(e,t);if(!i)return;const a=e[i];return typeof a=="string"?a.trim():a},Fe=e=>{if(!e)return null;const t=e.includes("T")?e:e.replace(" ","T"),i=new Date(t);return Number.isNaN(i.getTime())?null:i},oe=(e,t,i)=>{if(!e)return null;const a=J(e,t),d=Fe(a);if(!d)return null;const u=J(e,i),g=u==null||u===""?null:Number(u);return{raw:a,date:d,value:Number.isNaN(g)?null:g}},Oe=e=>{if(!e||e.length===0)return{gd:null,uni:null};const t=e[e.length-1];return{gd:oe(t,I.GD_TIME,I.GD_VALUE),uni:oe(t,I.UNI_TIME,I.UNI_VALUE)}},ne=(e=[])=>{const t=new Set,i=[];return e.forEach(a=>{const d=J(a,I.GD_TIME)||"",u=J(a,I.UNI_TIME)||"",g=`${d}|||${u}`;t.has(g)||(t.add(g),i.push(a))}),i},ie=e=>{if(!e||!e.Timestamp)return null;const t=e.Timestamp.trim();if(!t)return null;const i=t.includes("T")?t:t.replace(" ","T"),a=new Date(i);if(Number.isNaN(a.getTime()))return null;const d=Number(e.CurrentFreeGroupCounterValue);return{raw:t,date:a,value:Number.isNaN(d)?null:d}},Me=(e=[])=>Array.isArray(e)?e.map(t=>({...t||{}})):[],Ge=(e,t)=>({[I.GD_TIME]:e?.Timestamp||"",[I.GD_VALUE]:e?.CurrentFreeGroupCounterValue??"",[I.UNI_TIME]:t?.Timestamp||"",[I.UNI_VALUE]:t?.CurrentFreeGroupCounterValue??""}),le=()=>{if(typeof localStorage>"u")return{rows:[],timestamp:null,last:{gd:null,uni:null}};const e=localStorage.getItem(Y);if(!e)return{rows:[],timestamp:null,last:{gd:null,uni:null}};try{const t=JSON.parse(e),i=Array.isArray(t.data)?t.data:[];return{rows:i,timestamp:t.timestamp||null,last:Oe(i)}}catch(t){return console.error("Failed to parse history cache snapshot:",t),{rows:[],timestamp:null,last:{gd:null,uni:null}}}},He=({children:e})=>{const t=h(r=>r.setRealtimeData),i=h(r=>r.setRealtimeLoading),a=h(r=>r.setRealtimeError),d=h(r=>r.setLastRealtimeUpdate),u=h(r=>r.setHistoryData),g=h(r=>r.setHistoryLoading),b=h(r=>r.setLastHistoryUpdate);h(r=>r.fetchInProgress),h(r=>r.setFetchInProgress);const p=h(r=>r.setRefreshCallback),R=h(r=>r.setStopAutoRefresh),f=h(r=>r.historyData),N=S.useRef(!1),o=h(r=>r.cacheCleared),w=S.useCallback(r=>{const c=Array.isArray(r)?r:[],y=new Date;u(c),b(y);try{localStorage.setItem(Y,JSON.stringify({data:c,timestamp:y.toISOString()})),console.log("History cache updated")}catch(l){console.error("Failed to cache history data:",l)}},[u,b]),E=S.useCallback(async r=>{try{const c=r[0],y=r[1];if(!c||!y){console.log("Missing data for form submission");return}const l=c.CurrentFreeGroupCounterValue||0,n=c.Timestamp||"",m=y.CurrentFreeGroupCounterValue||0,x=y.Timestamp||"",L=new URLSearchParams;L.append(q.GREENDAY_VALUE,l.toString()),L.append(q.GREENDAY_TIME,n),L.append(q.UNI_VALUE,m.toString()),L.append(q.UNI_TIME,x),console.log("Submitting to Google Form:",{greenDay:{value:l,time:n},uni:{value:m,time:x}});const _=await fetch(Ae,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:L.toString(),mode:"no-cors"});console.log("Form submission completed")}catch(c){console.error("Failed to submit to Google Form:",c)}},[]),A=S.useCallback(async()=>{if(o){console.log("Cache cleared â€” skipping history fetch");return}g(!0);try{const c=await(await fetch(`${Ue}&time=${Date.now()}`,{cache:"no-store"})).text();Le.parse(c,{header:!0,skipEmptyLines:!0,complete:y=>{const l=ne(y.data||[]);console.log("CSV fetched, parsed, and deduplicated"),w(l),g(!1)}})}catch(r){console.error("Failed to fetch history data:",r),g(!1)}},[w,g]),U=S.useCallback(async()=>{if(o){console.log("Cache cleared â€” skipping realtime fetch");return}if(N.current){console.log("Fetch already in progress, skipping...");return}N.current=!0,i(!0),a(null);try{const r=localStorage.getItem(se);if(r)try{const l=JSON.parse(r);t(l.data),d(new Date(l.timestamp)),console.log("Real-time cache loaded")}catch(l){console.error("Failed to parse real-time cache:",l)}const c=await Promise.all(_e.map(l=>fetch(`${ke}${encodeURIComponent(l+"?time="+Date.now())}`).then(n=>n.ok?n.json():Promise.reject(`HTTP ${n.status}`))));t(c);const y=new Date;d(y);try{localStorage.setItem(se,JSON.stringify({data:c,timestamp:y.toISOString()}))}catch(l){console.error("Failed to cache real-time data:",l)}await H(c)}catch(r){console.error("Failed to fetch real-time data:",r),a(r.toString())}finally{i(!1),N.current=!1}},[t,i,a,d]),H=S.useCallback(async r=>{try{const c=ie(r[0]),y=ie(r[1]);console.log("API timestamps:",{gd:c?.date?.toISOString(),uni:y?.date?.toISOString()});let l=le();l.rows.length&&f.length===0&&(u(l.rows),l.timestamp&&b(new Date(l.timestamp)));const n=!c?.date||l.last.gd?.date&&c.date.getTime()<=l.last.gd.date.getTime(),m=!y?.date||l.last.uni?.date&&y.date.getTime()<=l.last.uni.date.getTime();if(l.rows.length>0&&n&&m){console.log("Fast path hit â€” cache already covers API timestamps");return}console.log("Slow path triggered â€” fetching CSV for reconciliation"),await A(),l=le(),l.rows.length&&(u(l.rows),l.timestamp&&b(new Date(l.timestamp)));const L=c?.date?!l.last.gd?.date||c.date.getTime()>l.last.gd.date.getTime():!1,_=y?.date?!l.last.uni?.date||y.date.getTime()>l.last.uni.date.getTime():!1;if(!L&&!_){console.log("After reconciliation, no newer timestamps detected");return}const C=Me(r);for(;C.length<2;)C.push({});if(l.last.gd?.date){const v=c?.date;(!v||v.getTime()<l.last.gd.date.getTime())&&(C[0]={...C[0],Timestamp:l.last.gd.raw,CurrentFreeGroupCounterValue:l.last.gd.value??C[0].CurrentFreeGroupCounterValue??0})}if(l.last.uni?.date){const v=y?.date;(!v||v.getTime()<l.last.uni.date.getTime())&&(C[1]={...C[1],Timestamp:l.last.uni.raw,CurrentFreeGroupCounterValue:l.last.uni.value??C[1].CurrentFreeGroupCounterValue??0})}await E(C);const k=ne([...l.rows,Ge(C[0],C[1])]);w(k)}catch(c){console.error("Error checking history update:",c)}},[A,f.length,w,E]);S.useEffect(()=>{const r=localStorage.getItem(Y);if(r)try{const c=JSON.parse(r);u(c.data),b(new Date(c.timestamp)),console.log("History cache loaded on mount")}catch(c){console.error("Failed to load history cache on mount:",c)}},[u,b]),S.useEffect(()=>{if(o){console.log("Cache cleared â€” skipping initial realtime fetch and auto-refresh");return}U();const r=setInterval(U,300*1e3);try{R(()=>()=>clearInterval(r))}catch(c){console.warn("Failed to register stopAutoRefresh",c)}return()=>clearInterval(r)},[U,R,o]);const j=S.useCallback(async()=>{console.log("Manual refresh triggered"),await U()},[U]);S.useEffect(()=>{p(j)},[j,p]);const D=h(r=>r.realtimeData),V=h(r=>r.realtimeLoading),$=h(r=>r.realtimeError),P=h(r=>r.lastRealtimeUpdate),O=h(r=>r.historyLoading),K=h(r=>r.lastHistoryUpdate),M={realtimeData:D,realtimeLoading:V,realtimeError:$,lastRealtimeUpdate:P,historyData:f,historyLoading:O,lastHistoryUpdate:K,refresh:j};return s.jsx(Ie.Provider,{value:M,children:e})},pe=({title:e,shortTitle:t,icon:i,onRefresh:a,updateStatus:d,currentView:u,setView:g,children:b})=>{const{isLight:p,toggleTheme:R}=ue();return s.jsxs("header",{className:"header-controls",children:[s.jsxs("div",{className:"header-title-group",children:[s.jsxs("h1",{children:[s.jsx("span",{className:"title-icon",children:i}),s.jsxs("span",{className:"title-text-full",children:[" ",e]}),s.jsxs("span",{className:"title-text-short",children:[" ",t||e]})]}),s.jsx("div",{className:"status-info",children:d})]}),s.jsxs("div",{className:"header-actions",children:[b,(typeof window<"u"?new URLSearchParams(window.location.search):new URLSearchParams).has("clear_cache")?s.jsxs("button",{className:"nav-btn",onClick:()=>he(),children:[s.jsx("span",{className:"btn-icon",children:"ðŸ§¹"}),s.jsx("span",{className:"btn-text",children:"Clear Cache"})]}):a?s.jsxs("button",{className:"nav-btn",onClick:a,children:[s.jsx("span",{className:"btn-icon",children:"âŸ³"}),s.jsx("span",{className:"btn-text",children:"Refresh"})]}):null,u==="stats"&&s.jsxs("button",{className:"nav-btn",onClick:()=>g("dashboard"),children:[s.jsx("span",{className:"btn-icon",children:"ðŸ "}),s.jsx("span",{className:"btn-text",children:"Dashboard"})]}),u==="dashboard"&&s.jsxs("button",{className:"nav-btn",onClick:()=>g("stats"),children:[s.jsx("span",{className:"btn-icon",children:"ðŸ“Š"}),s.jsx("span",{className:"btn-text",children:"Statistics"})]}),s.jsx("button",{className:"theme-toggle",onClick:R,"aria-label":"Toggle theme",children:p?"ðŸŒ™":"â˜€ï¸"})]})]})},Ve=({data:e,now:t})=>{const i=new Date(e.Timestamp.replace(" ","T")),a=Math.max(0,Math.floor((t-i)/1e3/60));let d="";a>=15?d="age-old":a>5&&(d="age-medium");let u=e.ParkingGroupName;return u==="Bank_1"&&(u="Uni Wroc"),s.jsxs("div",{className:"parking-card",children:[s.jsx("div",{className:"parking-name",children:u}),s.jsx("div",{className:`free-spots ${d}`,children:e.CurrentFreeGroupCounterValue||0}),s.jsxs("div",{className:"age-indicator-small",children:[a," min ago"]}),s.jsxs("div",{className:"timestamp-small",children:["@",i.toLocaleTimeString("pl-PL")]})]})},$e=({setView:e})=>{const t=h(o=>o.realtimeData),i=h(o=>o.realtimeLoading),a=h(o=>o.realtimeError),d=h(o=>o.lastRealtimeUpdate),[u,g]=S.useState(new Date);S.useEffect(()=>{const o=setInterval(()=>g(new Date),1e3);return()=>clearInterval(o)},[]);const b=t.reduce((o,w)=>o+(w.CurrentFreeGroupCounterValue||0),0),p=d?`Last update: ${d.toLocaleTimeString("pl-PL")}`:"Loading...",R=()=>{if(t.length===0)return{colorClass:"",statusMessage:"No data available"};let o=0;return t.forEach(w=>{const E=new Date(w.Timestamp.replace(" ","T")),A=Math.max(0,Math.floor((u-E)/1e3/60));o=Math.max(o,A)}),o>=15?{colorClass:"age-old",statusMessage:"Data outdated - figures may not reflect actual free spaces"}:o>5?{colorClass:"age-medium",statusMessage:"Data slightly outdated - refresh recommended"}:{colorClass:"",statusMessage:"Data is current and reliable"}},{colorClass:f,statusMessage:N}=R();return s.jsxs(s.Fragment,{children:[s.jsx(pe,{title:"Parking Monitor",icon:"ðŸ…¿ï¸",onRefresh:me,updateStatus:p,currentView:"dashboard",setView:e}),s.jsxs("main",{className:"container-main",children:[s.jsx("div",{className:"subtitle",children:"Real-time parking availability â€¢ UBS WrocÅ‚aw"}),a&&s.jsxs("div",{className:"error",children:[s.jsx("strong",{children:"ERROR:"})," ",a]}),s.jsx("div",{className:"grid-container",children:i&&t.length===0?s.jsx("div",{className:"loader",children:"Loading parking data..."}):t.map((o,w)=>s.jsx(Ve,{data:o,now:u},w))}),s.jsx("div",{className:`status-description ${f}`,children:N}),s.jsx("div",{className:"status-panel",children:s.jsxs("div",{className:"panel-sections-wrapper",children:[s.jsxs("div",{className:"panel-section",children:[s.jsx("div",{className:"status-label",children:"Total Spaces"}),s.jsx("div",{className:`status-value big-value ${f}`,children:i?"---":b})]}),s.jsxs("div",{className:"panel-section",children:[s.jsx("div",{className:"status-label",children:"Last Update / Current Time"}),s.jsxs("div",{className:"time-group",children:[s.jsx("span",{children:d?d.toLocaleTimeString("pl-PL"):"--:--:--"}),s.jsx("span",{className:"status-current-inline",children:u.toLocaleTimeString("pl-PL")})]})]}),s.jsxs("div",{className:"panel-section",children:[s.jsx("div",{className:"status-label",children:"Data Status"}),s.jsx("div",{className:"status-value",style:{color:a?"var(--warning)":"var(--success)"},children:i?"LOADING":a?"OFFLINE":"ONLINE"})]})]})})]})]})},z={neon:{gd:"#05ffa1",uni:"#01beff"},classic:{gd:"#3b82f6",uni:"#f59e0b"},cyberpunk:{gd:"#00d9ff",uni:"#ff00cc"},modern:{gd:"#10b981",uni:"#6366f1"}},Ke=({setView:e})=>{const t=h(o=>o.historyData),i=h(o=>o.historyLoading),[a,d]=F.useState("neon"),[u,g]=F.useState(!1),{isLight:b}=ue(),p=S.useRef({start:0,end:100}),R=S.useRef(null),f=S.useMemo(()=>{if(!t||t.length===0)return null;const o=b?"#1e293b":"#8b95c9",w=b?"#cbd5e1":"#2d3b6b",E=window.innerWidth<=600,A=new Map,U=new Map;t.forEach(n=>{const m=k=>Object.keys(n).find(v=>v.trim().toLowerCase()===k),x=m("gd_time"),L=m("greenday free"),_=m("uni_time"),C=m("uni free");if(x&&L&&n[x]&&n[L]){const k=n[x].trim(),v=parseFloat(n[L]);isNaN(v)||A.set(k,v)}if(_&&C&&n[_]&&n[C]){const k=n[_].trim(),v=parseFloat(n[C]);isNaN(v)||U.set(k,v)}});const H=n=>Array.from(n.entries()).map(([m,x])=>({t:new Date(m),v:x,raw:m})).filter(m=>!isNaN(m.t.getTime())).sort((m,x)=>m.t-x.t);let j=H(A),D=H(U);const V=n=>{const m=new Set;return n.filter(x=>{const L=`${x.raw}|${x.v}`;return m.has(L)?!1:(m.add(L),!0)})};if(j=V(j),D=V(D),j.length>0&&D.length>0){const n=j[0].t.getTime(),m=D[0].t.getTime();m<n&&(D[0].t=new Date(n),D[0].raw=j[0].raw),n<m&&(j[0].t=new Date(m),j[0].raw=D[0].raw)}const $=[...j.map(n=>n.t.getTime()),...D.map(n=>n.t.getTime())],P=$.length>0?Math.max(...$):null;let O=null;if(P){const n=j.find(x=>x.t.getTime()===P),m=D.find(x=>x.t.getTime()===P);O=(n||m)?.raw}const K=(n,m,x)=>{if(n.length===0)return{solid:[],gaps:[],projections:[]};const L=[],_=[],C=[],k=2400*1e3;for(let T=0;T<n.length;T++)L.push([n[T].raw,n[T].v]),T<n.length-1&&n[T+1].t-n[T].t>k&&(L.push([n[T+1].raw,null]),_.push([n[T].raw,n[T].v],[n[T+1].raw,n[T+1].v],[n[T+1].raw,null]));const v=n[n.length-1];return v&&m&&m-v.t.getTime()>1e3&&(C.push([v.raw,v.v]),C.push([x,v.v])),{solid:L,gaps:_,projections:C}},M=K(j,P,O),r=K(D,P,O),c=z[a],y=j.length>0?"GreenDay":"GreenDay - not found",l=D.length>0?"Uni Wroc":"Uni Wroc - not found";return{backgroundColor:"transparent",animation:!0,animationDuration:300,tooltip:{trigger:"axis",confine:!0,axisPointer:{type:"cross"}},legend:{data:[y,l],top:5,textStyle:{color:o}},grid:{left:E?10:15,right:E?10:15,bottom:E?80:50,top:40,containLabel:!0},xAxis:{type:"time",axisLabel:{color:o,margin:10},axisLine:{lineStyle:{color:w}},splitLine:{show:!1}},yAxis:{type:"value",min:-5,max:200,splitLine:{lineStyle:{color:w,opacity:.3}},axisLabel:{color:o,formatter:n=>n<0?"":n}},dataZoom:[{type:"inside",start:p.current.start,end:p.current.end,filterMode:"none"},{type:"slider",start:p.current.start,end:p.current.end,bottom:E?40:10,height:E?30:25,textStyle:{color:o,fontSize:E?11:12},filterMode:"none",handleSize:E?"180%":"100%",borderColor:o,fillerColor:"rgba(100, 149, 237, 0.3)",dataBackground:{lineStyle:{color:o,opacity:.5},areaStyle:{color:o,opacity:.2}},moveHandleSize:E?10:7,emphasis:{handleStyle:{borderWidth:2}}}],series:[{name:y,type:"line",data:M.solid,showSymbol:u,lineStyle:{width:3,color:c.gd},itemStyle:{color:c.gd},areaStyle:{color:new Z(0,0,0,1,[{offset:0,color:`${c.gd}33`},{offset:1,color:`${c.gd}00`}])},markLine:{symbol:"none",data:[{yAxis:187,lineStyle:{color:c.gd,type:"dotted",opacity:1},label:{position:"start",formatter:"187",color:c.gd,fontWeight:"bold",fontSize:13}}]}},{name:y,type:"line",data:M.gaps,showSymbol:!1,lineStyle:{width:2,color:c.gd,type:"dashed",opacity:.4},tooltip:{show:!1}},{name:y,type:"line",data:M.projections,showSymbol:!1,lineStyle:{width:1.5,color:c.gd,type:[5,5],opacity:.5},tooltip:{show:!1}},{name:l,type:"line",data:r.solid,showSymbol:u,lineStyle:{width:3,color:c.uni},itemStyle:{color:c.uni},areaStyle:{color:new Z(0,0,0,1,[{offset:0,color:`${c.uni}33`},{offset:1,color:`${c.uni}00`}])},markLine:{symbol:"none",data:[{yAxis:41,lineStyle:{color:c.uni,type:"dotted",opacity:1},label:{position:"start",formatter:"41",color:c.uni,fontWeight:"bold",fontSize:13}}]}},{name:l,type:"line",data:r.gaps,showSymbol:!1,lineStyle:{width:2,color:c.uni,type:"dashed",opacity:.4},tooltip:{show:!1}},{name:l,type:"line",data:r.projections,showSymbol:!1,lineStyle:{width:1.5,color:c.uni,type:[5,5],opacity:.5},tooltip:{show:!1}}]}},[t,a,u,b]),N={datazoom:o=>{o.batch&&o.batch[0]?p.current={start:o.batch[0].start,end:o.batch[0].end}:o.start!==void 0&&o.end!==void 0&&(p.current={start:o.start,end:o.end})}};return s.jsxs("div",{className:"page-wrapper",children:[s.jsx(pe,{title:"Parking History",shortTitle:"Hist",icon:"ðŸ“ˆ",onRefresh:me,updateStatus:i?"Updating...":"Ready",currentView:"stats",setView:e,children:s.jsxs("div",{className:"palette-group",children:[s.jsx("span",{className:"palette-label",children:"Palette:"}),Object.keys(z).map(o=>s.jsx("div",{className:`palette-btn ${a===o?"active":""}`,style:{background:`linear-gradient(135deg, ${z[o].gd} 50%, ${z[o].uni} 50%)`},onClick:()=>d(o),title:o.charAt(0).toUpperCase()+o.slice(1)},o)),s.jsxs("button",{className:"palette-toggle-btn",onClick:()=>g(!u),children:["Dots: ",u?"Off":"On"]})]})}),s.jsx("main",{className:"stats-container",children:i&&t.length===0?s.jsx("div",{className:"loader",children:"Loading history data..."}):f?s.jsx(fe,{ref:R,option:f,style:{height:"100%",width:"100%",touchAction:"none"},onEvents:N,notMerge:!1,lazyUpdate:!0,opts:{renderer:"canvas"}}):s.jsx("div",{className:"loader",children:"No data available to display."})})]})};function We(){const[e,t]=S.useState("dashboard");return s.jsx(Re,{children:s.jsx(He,{children:e==="dashboard"?s.jsx($e,{setView:t}):s.jsx(Ke,{setView:t})})})}const qe=ve.createRoot(document.getElementById("root"));qe.render(s.jsx(F.StrictMode,{children:s.jsx(We,{})}));
